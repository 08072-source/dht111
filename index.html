<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ESP32 Monitor</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  font-family: Arial;
  background: #111;
  color: white;
  text-align: center;
}
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ESP32 Monitor</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  background:#111;
  color:white;
  font-family:Arial;
}

h1{
  text-align:center;
  padding:10px;
}

/* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ */
#chart-container{
  width:100vw;
  height:90vh;
}

canvas{
  width:100% !important;
  height:100% !important;
}
</style>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ESP32 IoT Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

body{
  margin:0;
  background:#0d1117;
  color:white;
  font-family:Arial;
}

h1{
  text-align:center;
  margin-top:10px;
}

#data-box{
  display:flex;
  justify-content:center;
  gap:40px;
  font-size:24px;
  margin-bottom:10px;
}

.card{
  background:#161b22;
  padding:15px 25px;
  border-radius:10px;
}

#chart-container{
  width:100vw;
  height:75vh;
}

canvas{
  width:100% !important;
  height:100% !important;
}

</style>
</head>

<body>

<h1>ESP32 Sensor Dashboard</h1>

<div id="data-box">
  <div class="card">üå° Temp : <span id="tempNow">--</span> ¬∞C</div>
  <div class="card">üíß Hum : <span id="humNow">--</span> %</div>
</div>

<div id="chart-container">
  <canvas id="chart"></canvas>
</div>

<script>

const csvUrl = "https://docs.google.com/spreadsheets/d/1is4HVAGQwXNXCZynw3pWGqbM8o_pfZOqkvZQCEfBc_I/export?format=csv&gid=0";

let chart;

async function loadData(){

  const res = await fetch(csvUrl);
  const text = await res.text();

  const rows = text.split("\n").slice(1);

  let time = [];
  let temp = [];
  let hum = [];

  rows.forEach(r=>{
    let col = r.split(",");

    if(col[0] && col[1] && col[2]){

      let t = new Date(col[0]);

      // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏ö‡∏ö HH:MM
      let timeLabel = t.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});

      time.push(timeLabel);
      temp.push(parseFloat(col[1]));
      hum.push(parseFloat(col[2]));
    }
  });

  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  document.getElementById("tempNow").innerText = temp[temp.length-1];
  document.getElementById("humNow").innerText = hum[hum.length-1];

  drawChart(time,temp,hum);
}

function drawChart(time,temp,hum){

  if(chart) chart.destroy();

  chart = new Chart(document.getElementById("chart"),{

    type:"line",

    data:{
      labels:time,
      datasets:[
        {
          label:"Temperature ¬∞C",
          data:temp,
          borderWidth:2,
          tension:0.3
        },
        {
          label:"Humidity %",
          data:hum,
          borderWidth:2,
          tension:0.3
        }
      ]
    },

    options:{
      responsive:true,
      maintainAspectRatio:false,

      scales:{
        x:{
          ticks:{
            maxRotation:45,
            minRotation:45,
            maxTicksLimit:12,
            color:"white"
          }
        },
        y:{
          ticks:{
            color:"white"
          }
        }
      },

      plugins:{
        legend:{
          labels:{
            color:"white"
          }
        }
      }
    }

  });

}

loadData();
setInterval(loadData,60000);

</script>

</body>
</html>
